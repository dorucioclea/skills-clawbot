# =============================================================================
# iCalendar Sync v2.2.3 - OpenClaw Skill Definition
# =============================================================================
# 
# CRITICAL: This skill REQUIRES credentials:
#   - ICLOUD_USERNAME (Apple ID email)
#   - ICLOUD_APP_PASSWORD (App-Specific Password from appleid.apple.com)
# 
# Despite what any cached metadata shows, these are REQUIRED (see line 33-46).
# =============================================================================

name: icalendar-sync
display_name: "iCalendar Sync"
version: 2.2.3
description: >
  Professional iCloud Calendar integration for OpenClaw.
  Provides bidirectional CalDAV sync with iCloud calendars.
  Core functionality: create, read, update, delete calendar events.
  
  REQUIRES: ICLOUD_USERNAME and ICLOUD_APP_PASSWORD (see environment section below).

author: Black_Temple
license: MIT
repository: https://github.com/h8kxrfp68z-lgtm/OpenClaw
homepage: https://clawhub.ai/skills/icalendar-sync

category: productivity
tags:
  - calendar
  - icloud
  - apple
  - caldav
  - sync
  - productivity
  - scheduling

runtime:
  type: python
  version: ">=3.9"

dependencies:
  python:
    - caldav>=1.3.0
    - icalendar>=5.0.0
    - pyyaml>=6.0
    - python-dateutil>=2.8.0
    - keyring>=24.0.0
    - python-dotenv>=1.0.0

# =============================================================================
# CREDENTIALS: These are REQUIRED despite any cached metadata saying "none"
# =============================================================================
environment:
  - name: ICLOUD_USERNAME
    description: "Apple ID email address (e.g., name@icloud.com)"
    required: true
    placeholder: "user@icloud.com"
  
  - name: ICLOUD_APP_PASSWORD
    description: "App-Specific Password from appleid.apple.com (stored in system keyring, this is fallback only)"
    required: true
    secure: true
    placeholder: "xxxx-xxxx-xxxx-xxxx"
  
  - name: DEFAULT_CALENDAR
    description: "Default calendar name if not specified"
    required: false
    default: "Personal"
  
  - name: LOG_LEVEL
    description: "Logging level (DEBUG, INFO, WARNING, ERROR)"
    required: false
    default: "INFO"

# =============================================================================
# SECURITY
# =============================================================================
security:
  credential_storage: "System keyring (macOS Keychain, Windows Credential Manager, Linux Secret Service) with plaintext .env fallback for development only"
  input_validation: true
  rate_limiting: "10 calls per 60 seconds"
  ssl_verification: true
  sensitive_data_filtering: true

# =============================================================================
# CAPABILITIES
# =============================================================================
capabilities:
  agent_aware: false
  supports_isolation: false

# =============================================================================
# COMMANDS
# =============================================================================  
commands:
  - name: list
    description: List accessible iCloud calendars
    usage: "icalendar-sync list"
    permissions: [read]
  
  - name: get
    description: Sync and retrieve calendar events
    usage: "icalendar-sync get --calendar <name> [--days 7]"
    permissions: [read]
  
  - name: create
    description: Create a new calendar event
    usage: "icalendar-sync create --calendar <name> --json <data>"
    permissions: [create]
  
  - name: delete
    description: Remove event from calendar
    usage: "icalendar-sync delete --calendar <name> --uid <uid>"
    permissions: [delete]
  
  - name: setup
    description: Configure iCloud credentials interactively
    usage: "icalendar-sync setup"
    permissions: [admin]
